import { Component, HostListener, Input, HostBinding } from "@angular/core";
import * as i0 from "@angular/core";
/**
 * Get started with importing the module:
 *
 * ```typescript
 * import { ContextMenuModule } from 'carbon-components-angular';
 * ```
 *
 * [See demo](../../?path=/story/components-context-menu--basic)
 */
export class ContextMenuComponent {
    constructor(elementRef) {
        this.elementRef = elementRef;
        this.open = false;
        this.position = {
            left: 0,
            top: 0
        };
        this.contextMenu = true;
        this.role = "menu";
        this.tabindex = "-1";
    }
    get contextMenuOpen() { return this.open; }
    get showMenu() { return this.open; }
    get leftPosition() { return this.position.left; }
    get topPosition() { return this.position.top; }
    get classIcons() {
        const svgElement = this.elementRef.nativeElement
            .querySelector(".cds--menu-item .cds--menu-item__icon svg");
        return svgElement;
    }
    ngOnChanges(changes) {
        if (changes.open && changes.open.currentValue) {
            this.focusMenu();
        }
    }
    focusMenu() {
        // wait until the next tick to let the DOM settle before changing the focus
        setTimeout(() => {
            const list = this.elementRef.nativeElement;
            const firstOption = list.querySelector(".cds--menu-item");
            firstOption.focus();
        });
    }
    handleNavigation(event) {
        const list = this.elementRef.nativeElement;
        const subMenus = Array.from(list.querySelectorAll("cds-context-menu[role=menu]"));
        const menuItems = Array.from(list.querySelectorAll(".cds--menu-item"))
            .filter(menuItem => !subMenus.some(subMenu => subMenu.contains(menuItem)));
        const currentIndex = menuItems.findIndex(menuItem => parseInt(menuItem.getAttribute("tabindex"), 10) === 0);
        const currentMenuItem = menuItems[currentIndex];
        switch (event.key) {
            case "ArrowDown": {
                if (document.activeElement === list) {
                    menuItems[0].focus();
                }
                else {
                    if (currentIndex !== -1 && currentIndex < menuItems.length - 1) {
                        menuItems[currentIndex + 1].focus();
                    }
                }
                break;
            }
            case "ArrowUp": {
                if (document.activeElement === list) {
                    menuItems[menuItems.length - 1].focus();
                }
                else {
                    if (currentIndex !== -1 && currentIndex > 0) {
                        menuItems[currentIndex - 1].focus();
                    }
                }
                break;
            }
            case "ArrowRight": {
                if (currentIndex !== -1 && subMenus.some(subMenu => currentMenuItem.contains(subMenu))) {
                    currentMenuItem.click();
                }
                break;
            }
            case "ArrowLeft": {
                const parent = currentMenuItem.parentElement.closest(".cds--menu-item, .cds--menu-item");
                if (parent) {
                    parent.focus();
                }
                break;
            }
        }
    }
}
ContextMenuComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "14.3.0", ngImport: i0, type: ContextMenuComponent, deps: [{ token: i0.ElementRef }], target: i0.ɵɵFactoryTarget.Component });
ContextMenuComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "14.3.0", type: ContextMenuComponent, selector: "cds-context-menu, ibm-context-menu", inputs: { open: "open", position: "position" }, host: { listeners: { "keydown": "handleNavigation($event)" }, properties: { "class.cds--menu": "this.contextMenu", "class.cds--menu--open": "this.contextMenuOpen", "class.cds--menu--shown": "this.showMenu", "attr.role": "this.role", "attr.tabindex": "this.tabindex", "style.left.px": "this.leftPosition", "style.top.px": "this.topPosition", "class.cds--menu--with-icons": "this.classIcons" } }, usesOnChanges: true, ngImport: i0, template: `
			<ng-content></ng-content>
	`, isInline: true, styles: [":host{display:block}\n"] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "14.3.0", ngImport: i0, type: ContextMenuComponent, decorators: [{
            type: Component,
            args: [{ selector: "cds-context-menu, ibm-context-menu", template: `
			<ng-content></ng-content>
	`, styles: [":host{display:block}\n"] }]
        }], ctorParameters: function () { return [{ type: i0.ElementRef }]; }, propDecorators: { open: [{
                type: Input
            }], position: [{
                type: Input
            }], contextMenu: [{
                type: HostBinding,
                args: ["class.cds--menu"]
            }], contextMenuOpen: [{
                type: HostBinding,
                args: ["class.cds--menu--open"]
            }], showMenu: [{
                type: HostBinding,
                args: ["class.cds--menu--shown"]
            }], role: [{
                type: HostBinding,
                args: ["attr.role"]
            }], tabindex: [{
                type: HostBinding,
                args: ["attr.tabindex"]
            }], leftPosition: [{
                type: HostBinding,
                args: ["style.left.px"]
            }], topPosition: [{
                type: HostBinding,
                args: ["style.top.px"]
            }], classIcons: [{
                type: HostBinding,
                args: ["class.cds--menu--with-icons"]
            }], handleNavigation: [{
                type: HostListener,
                args: ["keydown", ["$event"]]
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udGV4dC1tZW51LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb250ZXh0LW1lbnUvY29udGV4dC1tZW51LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQ04sU0FBUyxFQUVULFlBQVksRUFDWixLQUFLLEVBR0wsV0FBVyxFQUNYLE1BQU0sZUFBZSxDQUFDOztBQUV2Qjs7Ozs7Ozs7R0FRRztBQVlILE1BQU0sT0FBTyxvQkFBb0I7SUFxQmhDLFlBQXNCLFVBQXNCO1FBQXRCLGVBQVUsR0FBVixVQUFVLENBQVk7UUFwQm5DLFNBQUksR0FBRyxLQUFLLENBQUM7UUFDYixhQUFRLEdBQUc7WUFDbkIsSUFBSSxFQUFFLENBQUM7WUFDUCxHQUFHLEVBQUUsQ0FBQztTQUNOLENBQUM7UUFFOEIsZ0JBQVcsR0FBRyxJQUFJLENBQUM7UUFHekIsU0FBSSxHQUFHLE1BQU0sQ0FBQztRQUNWLGFBQVEsR0FBRyxJQUFJLENBQUM7SUFVRSxDQUFDO0lBYmpELElBQTBDLGVBQWUsS0FBSyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0lBQ2pGLElBQTJDLFFBQVEsS0FBSyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0lBRzNFLElBQWtDLFlBQVksS0FBSyxPQUFPLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztJQUMvRSxJQUFpQyxXQUFXLEtBQUssT0FBTyxJQUFJLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFFNUUsSUFBZ0QsVUFBVTtRQUN6RCxNQUFNLFVBQVUsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLGFBQWE7YUFDOUMsYUFBYSxDQUFDLDJDQUEyQyxDQUFnQixDQUFDO1FBQzVFLE9BQU8sVUFBVSxDQUFDO0lBQ25CLENBQUM7SUFJRCxXQUFXLENBQUMsT0FBc0I7UUFDakMsSUFBSSxP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Q0FBQyxLQUFLLEVBQUUsQ0FBQztpQkFDZjtnQkFDRCxNQUFNO2FBQ047U0FDRDtJQUNGLENBQUM7O2lIQXBGVyxvQkFBb0I7cUdBQXBCLG9CQUFvQiwwaEJBVHRCOztFQUVUOzJGQU9XLG9CQUFvQjtrQkFYaEMsU0FBUzsrQkFDQyxvQ0FBb0MsWUFDcEM7O0VBRVQ7aUdBUVEsSUFBSTtzQkFBWixLQUFLO2dCQUNHLFFBQVE7c0JBQWhCLEtBQUs7Z0JBSzBCLFdBQVc7c0JBQTFDLFdBQVc7dUJBQUMsaUJBQWlCO2dCQUNZLGVBQWU7c0JBQXhELFdBQVc7dUJBQUMsdUJBQXVCO2dCQUNPLFFBQVE7c0JBQWxELFdBQVc7dUJBQUMsd0JBQXdCO2dCQUNYLElBQUk7c0JBQTdCLFdBQVc7dUJBQUMsV0FBVztnQkFDTSxRQUFRO3NCQUFyQyxXQUFXO3VCQUFDLGVBQWU7Z0JBQ00sWUFBWTtzQkFBN0MsV0FBVzt1QkFBQyxlQUFlO2dCQUNLLFdBQVc7c0JBQTNDLFdBQVc7dUJBQUMsY0FBYztnQkFFcUIsVUFBVTtzQkFBekQsV0FBVzt1QkFBQyw2QkFBNkI7Z0JBd0IxQyxnQkFBZ0I7c0JBRGYsWUFBWTt1QkFBQyxTQUFTLEVBQUUsQ0FBQyxRQUFRLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuXHRDb21wb25lbnQsXG5cdEVsZW1lbnRSZWYsXG5cdEhvc3RMaXN0ZW5lcixcblx0SW5wdXQsXG5cdFNpbXBsZUNoYW5nZXMsXG5cdE9uQ2hhbmdlcyxcblx0SG9zdEJpbmRpbmdcbn0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcblxuLyoqXG4gKiBHZXQgc3RhcnRlZCB3aXRoIGltcG9ydGluZyB0aGUgbW9kdWxlOlxuICpcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGltcG9ydCB7IENvbnRleHRNZW51TW9kdWxlIH0gZnJvbSAnY2FyYm9uLWNvbXBvbmVudHMtYW5ndWxhcic7XG4gKiBgYGBcbiAqXG4gKiBbU2VlIGRlbW9dKC4uLy4uLz9wYXRoPS9zdG9yeS9jb21wb25lbnRzLWNvbnRleHQtbWVudS0tYmFzaWMpXG4gKi9cbkBDb21wb25lbnQoe1xuXHRzZWxlY3RvcjogXCJjZHMtY29udGV4dC1tZW51LCBpYm0tY29udGV4dC1tZW51XCIsXG5cdHRlbXBsYXRlOiBgXG5cdFx0XHQ8bmctY29udGVudD48L25nLWNvbnRlbnQ+XG5cdGAsXG5cdHN0eWxlczogW2Bcblx0XHQ6aG9zdCB7XG5cdFx0XHRkaXNwbGF5OiBibG9jaztcblx0XHR9XG5cdGBdXG59KVxuZXhwb3J0IGNsYXNzIENvbnRleHRNZW51Q29tcG9uZW50IGltcGxlbWVudHMgT25DaGFuZ2VzIHtcblx0QElucHV0KCkgb3BlbiA9IGZhbHNlO1xuXHRASW5wdXQoKSBwb3NpdGlvbiA9IHtcblx0XHRsZWZ0OiAwLFxuXHRcdHRvcDogMFxuXHR9O1xuXG5cdEBIb3N0QmluZGluZyhcImNsYXNzLmNkcy0tbWVudVwiKSBjb250ZXh0TWVudSA9IHRydWU7XG5cdEBIb3N0QmluZGluZyhcImNsYXNzLmNkcy0tbWVudS0tb3BlblwiKSBnZXQgY29udGV4dE1lbnVPcGVuKCkgeyByZXR1cm4gdGhpcy5vcGVuOyB9XG5cdEBIb3N0QmluZGluZyhcImNsYXNzLmNkcy0tbWVudS0tc2hvd25cIikgZ2V0IHNob3dNZW51KCkgeyByZXR1cm4gdGhpcy5vcGVuOyB9XG5cdEBIb3N0QmluZGluZyhcImF0dHIucm9sZVwiKSByb2xlID0gXCJtZW51XCI7XG5cdEBIb3N0QmluZGluZyhcImF0dHIudGFiaW5kZXhcIikgdGFiaW5kZXggPSBcIi0xXCI7XG5cdEBIb3N0QmluZGluZyhcInN0eWxlLmxlZnQucHhcIikgZ2V0IGxlZnRQb3NpdGlvbigpIHsgcmV0dXJuIHRoaXMucG9zaXRpb24ubGVmdDsgfVxuXHRASG9zdEJpbmRpbmcoXCJzdHlsZS50b3AucHhcIikgZ2V0IHRvcFBvc2l0aW9uKCkgeyByZXR1cm4gdGhpcy5wb3NpdGlvbi50b3A7IH1cblxuXHRASG9zdEJpbmRpbmcoXCJjbGFzcy5jZHMtLW1lbnUtLXdpdGgtaWNvbnNcIikgZ2V0IGNsYXNzSWNvbnMoKSB7XG5cdFx0Y29uc3Qgc3ZnRWxlbWVudCA9IHRoaXMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50XG5cdFx0XHQucXVlcnlTZWxlY3RvcihcIi5jZHMtLW1lbnUtaXRlbSAuY2RzLS1tZW51LWl0ZW1fX2ljb24gc3ZnXCIpIGFzIEhUTUxFbGVtZW50O1xuXHRcdHJldHVybiBzdmdFbGVtZW50O1xuXHR9XG5cblx0Y29uc3RydWN0b3IocHJvdGVjdGVkIGVsZW1lbnRSZWY6IEVsZW1lbnRSZWYpIHsgfVxuXG5cdG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpIHtcblx0XHRpZiAoY2hhbmdlcy5vcGVuICYmIGNoYW5nZXMub3Blbi5jdXJyZW50VmFsdWUpIHtcblx0XHRcdHRoaXMuZm9jdXNNZW51KCk7XG5cdFx0fVxuXHR9XG5cblx0Zm9jdXNNZW51KCkge1xuXHRcdC8vIHdhaXQgdW50aWwgdGhlIG5leHQgdGljayB0byBsZXQgdGhlIERPTSBzZXR0bGUgYmVmb3JlIGNoYW5naW5nIHRoZSBmb2N1c1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0Y29uc3QgbGlzdDogSFRNTEVsZW1lbnQgPSB0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudDtcblx0XHRcdGNvbnN0IGZpcnN0T3B0aW9uID0gbGlzdC5xdWVyeVNlbGVjdG9yKFwiLmNkcy0tbWVudS1pdGVtXCIpIGFzIEhUTUxFbGVtZW50O1xuXHRcdFx0Zmlyc3RPcHRpb24uZm9jdXMoKTtcblx0XHR9KTtcblx0fVxuXG5cdEBIb3N0TGlzdGVuZXIoXCJrZXlkb3duXCIsIFtcIiRldmVudFwiXSlcblx0aGFuZGxlTmF2aWdhdGlvbihldmVudDogS2V5Ym9hcmRFdmVudCkge1xuXHRcdGNvbnN0IGxpc3Q6IEhUTUxFbGVtZW50ID0gdGhpcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQ7XG5cdFx0Y29uc3Qgc3ViTWVudXM6IEhUTUxFbGVtZW50W10gPSBBcnJheS5mcm9tKGxpc3QucXVlcnlTZWxlY3RvckFsbChcImNkcy1jb250ZXh0LW1lbnVbcm9sZT1tZW51XVwiKSk7XG5cdFx0Y29uc3QgbWVudUl0ZW1zOiBIVE1MRWxlbWVudFtdID0gKFxuXHRcdFx0QXJyYXkuZnJvbShsaXN0LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY2RzLS1tZW51LWl0ZW1cIikpIGFzIEhUTUxFbGVtZW50W10pXG5cdFx0XHQuZmlsdGVyKG1lbnVJdGVtID0+ICFzdWJNZW51cy5zb21lKHN1Yk1lbnUgPT4gc3ViTWVudS5jb250YWlucyhtZW51SXRlbSkpXG5cdFx0KTtcblx0XHRjb25zdCBjdXJyZW50SW5kZXggPSBtZW51SXRlbXMuZmluZEluZGV4KG1lbnVJdGVtID0+IHBhcnNlSW50KG1lbnVJdGVtLmdldEF0dHJpYnV0ZShcInRhYmluZGV4XCIpLCAxMCkgPT09IDApO1xuXHRcdGNvbnN0IGN1cnJlbnRNZW51SXRlbSA9IG1lbnVJdGVtc1tjdXJyZW50SW5kZXhdO1xuXG5cdFx0c3dpdGNoIChldmVudC5rZXkpIHtcblx0XHRcdGNhc2UgXCJBcnJvd0Rvd25cIjoge1xuXHRcdFx0XHRpZiAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCA9PT0gbGlzdCkge1xuXHRcdFx0XHRcdG1lbnVJdGVtc1swXS5mb2N1cygpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGlmIChjdXJyZW50SW5kZXggIT09IC0xICYmIGN1cnJlbnRJbmRleCA8IG1lbnVJdGVtcy5sZW5ndGggLSAxKSB7XG5cdFx0XHRcdFx0XHRtZW51SXRlbXNbY3VycmVudEluZGV4ICsgMV0uZm9jdXMoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0XHRjYXNlIFwiQXJyb3dVcFwiOiB7XG5cdFx0XHRcdGlmIChkb2N1bWVudC5hY3RpdmVFbGVtZW50ID09PSBsaXN0KSB7XG5cdFx0XHRcdFx0bWVudUl0ZW1zW21lbnVJdGVtcy5sZW5ndGggLSAxXS5mb2N1cygpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGlmIChjdXJyZW50SW5kZXggIT09IC0xICYmIGN1cnJlbnRJbmRleCA+IDApIHtcblx0XHRcdFx0XHRcdG1lbnVJdGVtc1tjdXJyZW50SW5kZXggLSAxXS5mb2N1cygpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHRcdGNhc2UgXCJBcnJvd1JpZ2h0XCI6IHtcblx0XHRcdFx0aWYgKGN1cnJlbnRJbmRleCAhPT0gLTEgJiYgc3ViTWVudXMuc29tZShzdWJNZW51ID0+IGN1cnJlbnRNZW51SXRlbS5jb250YWlucyhzdWJNZW51KSkpIHtcblx0XHRcdFx0XHRjdXJyZW50TWVudUl0ZW0uY2xpY2soKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHRcdGNhc2UgXCJBcnJvd0xlZnRcIjoge1xuXHRcdFx0XHRjb25zdCBwYXJlbnQgPSBjdXJyZW50TWVudUl0ZW0ucGFyZW50RWxlbWVudC5jbG9zZXN0KFwiLmNkcy0tbWVudS1pdGVtLCAuY2RzLS1tZW51LWl0ZW1cIikgYXMgSFRNTEVsZW1lbnQ7XG5cdFx0XHRcdGlmIChwYXJlbnQpIHtcblx0XHRcdFx0XHRwYXJlbnQuZm9jdXMoKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHR9XG5cdH1cbn1cbiJdfQ==